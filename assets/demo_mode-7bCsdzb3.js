import{r as K,ba as L,aY as k,bb as E,bc as G,aN as Q,H as U,bd as z,v as n,G as Z,be as $,bf as ee,bg as te}from"./index--jBmlGKr.js";import{u as oe,d as C}from"./objd_worker_manager-I2tr17X6.js";const se="/app-dev/assets/live_preview_hand-EyeVukRw.png";let F=document.createElement("img");F.src=se;function ie(s,N,_,P){const{rh:e}=_,o=K(),T=P.target_rect,O=L(T),X=k(O,[E,G]),f=[o?.videoWidth??100,o?.videoHeight??100],S=Q(T,f[0]/f[1]);let r=k(S,f);if(U()&&(r=r.translate(f[0],0),r=r.flipX()),z(s,r,"fullscreen",_.frame_index),!!r.is2D){if(e.save(),e.setTransform(e.getTransform().multiply(r)),e.save(),o!=null){oe(s,o),e.save(),_.ctx.drawImage(o,0,0),e.restore();let x=null,u=!1,y=0;const a=C.hands[0];if(a!=null){C.handedness[0],e.save();const V=[[2,3,4],[6,7,8],[10,11,12],[14,15,16],[18,19,20]],Y=[[0,1,2],[0,5,6],[9,10],[13,14],[0,17,18],[5,9,13,17]],i=c=>[c.x*o.videoWidth,c.y*o.videoHeight];if(e.lineWidth=2,e.strokeStyle="#2955f4",s.settings.show_bounding_boxes){for(const c of V)for(const[b,v]of c.entries()){const l=i(a[v]);b==0?e.moveTo(...l):e.lineTo(...l)}e.stroke();for(const c of Y)for(const[b,v]of c.entries()){const l=i(a[v]);b==0?e.moveTo(...l):e.lineTo(...l)}e.globalAlpha=.2,e.stroke(),e.globalAlpha=1}const d=i(a[5]),H=i(a[17]),w=i(a[0]),I=n.sub(H,d),A=n.add(d,n.div(I,[2,2])),j=n.sub(w,A),g=n.getAngle(j)+Math.PI,D=n.rotateRad(I,-g),q=n.distance(d,H),B=n.distance(A,w),m=Z(s).bounds,M=.15,W=.15,h=[m[0]*(1-.15-M),m[1]*(1-0-W)];let t=new DOMMatrixReadOnly;t=t.translate(d[0],d[1]),t=t.rotate($(g)),D[0]<0&&(t=t.flipX()),t=t.scale(q/h[0],B/h[1]),t=t.translate(-m[0]*M,-m[1]*W);const J=r.multiply(t);e.setTransform(e.getTransform().multiply(t));const p=z(s,J,"fullscreen",_.frame_index);ee(e,s,p,{force_fast:!0,grid_path:{stroke:[41/255,85/255,244/255,p.scale<1?p.scale:1],fill:[1,1,1,1]}}),e.restore();const R=t.transformPoint({x:h[0]/2,y:h[1]/2});x=[R.x,R.y],D[0]<0&&(u=!0),y=g}te(u),s.active_mode?.mode.renderCamera?.({state:s,setState:N,ctx:e,size:[o.videoWidth,o.videoHeight],hand_center:x,hand_mirrored:u,hand_rotation:y})}e.restore(),e.restore(),e.save(),e.setTransform(e.getTransform().multiply(X)),e.drawImage(F,0,0,E,G),e.restore()}}export{ie as renderDemoMode};
