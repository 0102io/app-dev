import{v as o,G as L}from"./index--jBmlGKr.js";const E=.06,R=.08,B={config:{supports_line_thickness:!1,npe:!0,override_grid:"Glove v12c"},onDeactivate(i){const f=i.modes.npe_ball_bounce;f.sequence=[],f.game_state=void 0},renderCamera({state:i,setState:f,ctx:e,size:g,hand_center:m,hand_mirrored:t,hand_rotation:h}){const c=i.modes.npe_ball_bounce;g[0]!==0&&g[1]!==0&&(c.game_info??={hand_center:m,hand_mirrored:t,hand_rotation:h,size:g,ctx:e},c.game_info.hand_center=m,c.game_info.ctx=e,c.game_info.hand_mirrored=t,c.game_info.hand_rotation=h,c.game_state??=D(i,f,c.game_info),c.game_state.next())},sequencer:function*(i,f){const e=i.modes.npe_ball_bounce,g=e.sequence;e.sequence=[],yield g}};function*D(i,f,e){const g=i.modes.npe_ball_bounce,m=Math.min(e.size[0],e.size[1]),t=e.ctx,h=E*m,c=h*2;let u=o.div(e.size,[2,2]),a=[0,0];const r={left:0,top:0,right:0,bottom:0},y=500,b=m*R;let C=!1,A=Date.now();for(;;){yield;let s=Date.now();const G=(s-A)/1e3;A=s,e.hand_center!=null&&(t.strokeStyle="red",t.lineWidth=m/100,t.beginPath(),t.arc(...e.hand_center,c,0,2*Math.PI),t.stroke()),t.fillStyle="red",t.beginPath(),t.arc(...u,h,0,2*Math.PI),t.fill();let q=!1;if(e.hand_center!=null&&o.distance(e.hand_center,u)<h+c){q=!0;const d=o.normalize(o.sub(u,e.hand_center));if(a=o.mul(d,[m,m]),!C){const l=[],n=L(i);let S=[1/0,1/0],x=[-1/0,-1/0];for(let p=0;p<n.max_pts;p++){const _=n.ptCenter(p);l.push({pos:_,index:p}),S=[Math.min(S[0],_[0]),Math.min(S[1],_[1])],x=[Math.max(x[0],_[0]),Math.max(x[1],_[1])]}let z=o.add(S,o.div(o.sub(x,S),[2,2]));const I=o.sub(x,S);z=o.add(z,o.mul(o.rotateRad([d[0]*(e.hand_mirrored?-1:1),d[1]],e.hand_rotation*(e.hand_mirrored?1:-1)),o.div(I,[2,2]))),l.sort((p,_)=>{const v=Math.sqrt((p.pos[0]-z[0])**2+(p.pos[1]-z[1])**2),w=Math.sqrt((_.pos[0]-z[0])**2+(_.pos[1]-z[1])**2);return v-w});const k=l.flatMap((p,_,v)=>[p.index,{delay_ms:1/v.length*200}]);for(const p of k)g.sequence.push(p);i.play=!1,f(),i.play=!0,i.repeat=!1,f()}}if(C=q,u[0]<h&&(a=[Math.abs(a[0]),a[1]],r.left=s),u[1]<h&&(a=[a[0],Math.abs(a[1])],r.top=s),u[0]>e.size[0]-h&&(a=[-Math.abs(a[0]),a[1]],r.right=s),u[1]>e.size[1]-h&&(a=[a[0],-Math.abs(a[1])],r.bottom=s),u=o.add(u,o.mul(a,[G,G])),r.left>s-y){const d=(n=>n*n)(1-(s-r.left)/y),l=t.ctx.createLinearGradient(0,0,b,0);l.addColorStop(0,"rgba(110, 18, 223, 1)"),l.addColorStop(1,"rgba(110, 18, 223, 0)"),t.fillStyle=l,t.globalAlpha=d,t.fillRect(0,0,b,e.size[0]),t.fillStyle="black",t.globalAlpha=1}if(r.right>s-y){const d=(n=>n*n)(1-(s-r.right)/y),l=t.ctx.createLinearGradient(e.size[0]-b,0,e.size[0],0);l.addColorStop(0,"rgba(110, 18, 223, 0)"),l.addColorStop(1,"rgba(110, 18, 223, 1)"),t.fillStyle=l,t.globalAlpha=d,t.fillRect(e.size[0]-b,0,b,e.size[1]),t.fillStyle="black",t.globalAlpha=1}if(r.top>s-y){const d=(n=>n*n)(1-(s-r.top)/y),l=t.ctx.createLinearGradient(0,0,0,b);l.addColorStop(0,"rgba(110, 18, 223, 1)"),l.addColorStop(1,"rgba(110, 18, 223, 0)"),t.fillStyle=l,t.globalAlpha=d,t.fillRect(0,0,e.size[0],b),t.fillStyle="black",t.globalAlpha=1}if(r.bottom>s-y){const d=(n=>n*n)(1-(s-r.bottom)/y),l=t.ctx.createLinearGradient(0,e.size[1]-b,0,e.size[1]);l.addColorStop(0,"rgba(110, 18, 223, 0)"),l.addColorStop(1,"rgba(110, 18, 223, 1)"),t.fillStyle=l,t.globalAlpha=d,t.fillRect(0,e.size[1]-b,e.size[0],b),t.fillStyle="black",t.globalAlpha=1}}}export{B as default};
